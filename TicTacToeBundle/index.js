window.__require=function i(t,r,e){function o(n,a){if(!r[n]){if(!t[n]){var c=n.split("/");if(c=c[c.length-1],!t[c]){var h="function"==typeof __require&&__require;if(!a&&h)return h(c,!0);if(s)return s(c,!0);throw new Error("Cannot find module '"+n+"'")}n=c}var l=r[n]={exports:{}};t[n][0].call(l.exports,function(i){return o(t[n][1][i]||i)},l,l.exports,i,t,r,e)}return r[n].exports}for(var s="function"==typeof __require&&__require,n=0;n<e.length;n++)o(e[n]);return o}({TicTacToe:[function(i,t,r){"use strict";cc._RF.push(t,"f07e9GxXIZIapr/UpHTRGhb","TicTacToe");var e,o=this&&this.__extends||(e=function(i,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,t){i.__proto__=t}||function(i,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=t[r])})(i,t)},function(i,t){function r(){this.constructor=i}e(i,t),i.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),s=this&&this.__decorate||function(i,t,r,e){var o,s=arguments.length,n=s<3?t:null===e?e=Object.getOwnPropertyDescriptor(t,r):e;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(i,t,r,e);else for(var a=i.length-1;a>=0;a--)(o=i[a])&&(n=(s<3?o(n):s>3?o(t,r,n):o(t,r))||n);return s>3&&n&&Object.defineProperty(t,r,n),n};Object.defineProperty(r,"__esModule",{value:!0});var n,a=cc._decorator,c=a.ccclass,h=a.property;(function(i){i[i.None=0]="None",i[i.X=1]="X",i[i.O=2]="O"})(n||(n={}));var l=function(i){function t(){var t=null!==i&&i.apply(this,arguments)||this;return t.cellSize=150,t.lineWidth=10,t.isVsComputer=!0,t.graphics=null,t.board=[],t.currentPlayer=n.X,t.isGameOver=!1,t.isProcessing=!1,t.boardOrigin=cc.v2(0,0),t.scoreX=0,t.scoreO=0,t.scoreLabel=null,t.winLabel=null,t}return o(t,i),t.prototype.onLoad=function(){this.graphics=this.getComponent(cc.Graphics),this.graphics||(this.graphics=this.addComponent(cc.Graphics)),this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this),this.node.width=cc.winSize.width,this.node.height=cc.winSize.height,this.createLabels(),this.resetGame()},t.prototype.createLabels=function(){var i=new cc.Node("ScoreLabel");i.parent=this.node;var t=1.5*this.cellSize+60;i.setPosition(0,t),i.color=cc.Color.WHITE,this.scoreLabel=i.addComponent(cc.Label),this.scoreLabel.fontSize=40,this.scoreLabel.lineHeight=50,this.scoreLabel.horizontalAlign=cc.Label.HorizontalAlign.CENTER,this.updateScoreText();var r=new cc.Node("WinLabel");r.parent=this.node;var e=-1.5*this.cellSize-60;r.setPosition(0,e),r.color=cc.Color.YELLOW,this.winLabel=r.addComponent(cc.Label),this.winLabel.fontSize=50,this.winLabel.lineHeight=60,this.winLabel.horizontalAlign=cc.Label.HorizontalAlign.CENTER,this.winLabel.string=""},t.prototype.updateScoreText=function(){this.scoreLabel&&(this.scoreLabel.string="Player X: "+this.scoreX+"   -   Player O: "+this.scoreO)},t.prototype.resetGame=function(){this.board=[[0,0,0],[0,0,0],[0,0,0]],this.currentPlayer=n.X,this.isGameOver=!1,this.isProcessing=!1,this.winLabel&&(this.winLabel.string="");var i=3*this.cellSize;this.boardOrigin=cc.v2(-i/2,-i/2),this.drawBoard()},t.prototype.onTouchStart=function(i){if(this.isGameOver)this.resetGame();else if(!(this.isProcessing||this.isVsComputer&&this.currentPlayer!==n.X)){var t=this.node.convertToNodeSpaceAR(i.getLocation()),r=t.x-this.boardOrigin.x,e=t.y-this.boardOrigin.y,o=Math.floor(r/this.cellSize),s=Math.floor(e/this.cellSize);o>=0&&o<3&&s>=0&&s<3&&this.board[s][o]===n.None&&this.makeMove(s,o)}},t.prototype.makeMove=function(i,t){var r=this;this.board[i][t]=this.currentPlayer,this.drawPiece(i,t,this.currentPlayer),this.checkWin(this.currentPlayer)?this.handleWin(this.currentPlayer):this.checkDraw()?this.handleDraw():(this.currentPlayer=this.currentPlayer===n.X?n.O:n.X,this.isVsComputer&&this.currentPlayer===n.O&&(this.isProcessing=!0,this.scheduleOnce(function(){r.makeComputerMove(),r.isProcessing=!1},.5)))},t.prototype.handleWin=function(i){this.isGameOver=!0,i===n.X?(this.scoreX++,this.winLabel.string="Player X Wins!",this.winLabel.node.color=cc.Color.RED):(this.scoreO++,this.winLabel.string=this.isVsComputer?"Computer Wins!":"Player O Wins!",this.winLabel.node.color=cc.Color.CYAN),this.updateScoreText()},t.prototype.handleDraw=function(){this.isGameOver=!0,this.winLabel.string="It's a Draw!",this.winLabel.node.color=cc.Color.WHITE},t.prototype.makeComputerMove=function(){for(var i=-1/0,t={r:-1,c:-1},r=0;r<3;r++)for(var e=0;e<3;e++)if(this.board[r][e]===n.None){this.board[r][e]=n.O;var o=this.minimax(this.board,0,!1);this.board[r][e]=n.None,o>i&&(i=o,t={r:r,c:e})}-1!==t.r&&this.makeMove(t.r,t.c)},t.prototype.minimax=function(i,t,r){if(this.checkWinSimulation(n.O))return 10-t;if(this.checkWinSimulation(n.X))return t-10;if(this.checkDrawSimulation())return 0;if(r){for(var e=-1/0,o=0;o<3;o++)for(var s=0;s<3;s++)if(i[o][s]===n.None){i[o][s]=n.O;var a=this.minimax(i,t+1,!1);i[o][s]=n.None,e=Math.max(a,e)}return e}for(e=1/0,o=0;o<3;o++)for(s=0;s<3;s++)i[o][s]===n.None&&(i[o][s]=n.X,a=this.minimax(i,t+1,!0),i[o][s]=n.None,e=Math.min(a,e));return e},t.prototype.checkWinSimulation=function(i){for(var t=0;t<3;t++){if(this.board[t][0]==i&&this.board[t][1]==i&&this.board[t][2]==i)return!0;if(this.board[0][t]==i&&this.board[1][t]==i&&this.board[2][t]==i)return!0}return this.board[0][0]==i&&this.board[1][1]==i&&this.board[2][2]==i||this.board[2][0]==i&&this.board[1][1]==i&&this.board[0][2]==i},t.prototype.checkDrawSimulation=function(){for(var i=0;i<3;i++)for(var t=0;t<3;t++)if(this.board[i][t]===n.None)return!1;return!0},t.prototype.drawBoard=function(){this.graphics.clear(),this.graphics.lineWidth=this.lineWidth,this.graphics.strokeColor=cc.Color.WHITE,this.graphics.lineCap=cc.Graphics.LineCap.ROUND;for(var i=this.cellSize,t=this.boardOrigin.x,r=this.boardOrigin.y,e=t+3*i,o=r+3*i,s=1;s<3;s++){var n=t+s*i;this.graphics.moveTo(n,r),this.graphics.lineTo(n,o)}for(s=1;s<3;s++){var a=r+s*i;this.graphics.moveTo(t,a),this.graphics.lineTo(e,a)}this.graphics.stroke()},t.prototype.drawPiece=function(i,t,r){var e=this.cellSize,o=this.boardOrigin.x+t*e+e/2,s=this.boardOrigin.y+i*e+e/2,a=.3*e;this.graphics.lineWidth=8,r===n.X?(this.graphics.strokeColor=cc.Color.RED,this.graphics.moveTo(o-a,s-a),this.graphics.lineTo(o+a,s+a),this.graphics.moveTo(o+a,s-a),this.graphics.lineTo(o-a,s+a),this.graphics.stroke()):(this.graphics.strokeColor=cc.Color.CYAN,this.graphics.circle(o,s,a),this.graphics.stroke())},t.prototype.checkWin=function(i){for(var t=this,r=function(i,r,e,o){var s=t.cellSize,n=t.boardOrigin.x+r*s+s/2,a=t.boardOrigin.y+i*s+s/2,c=t.boardOrigin.x+o*s+s/2,h=t.boardOrigin.y+e*s+s/2;return t.graphics.lineWidth=15,t.graphics.strokeColor=cc.Color.YELLOW,t.graphics.moveTo(n,a),t.graphics.lineTo(c,h),t.graphics.stroke(),!0},e=0;e<3;e++)if(this.board[e][0]===i&&this.board[e][1]===i&&this.board[e][2]===i)return r(e,0,e,2);for(var o=0;o<3;o++)if(this.board[0][o]===i&&this.board[1][o]===i&&this.board[2][o]===i)return r(0,o,2,o);return this.board[0][0]===i&&this.board[1][1]===i&&this.board[2][2]===i?r(0,0,2,2):this.board[2][0]===i&&this.board[1][1]===i&&this.board[0][2]===i&&r(2,0,0,2)},t.prototype.checkDraw=function(){return this.checkDrawSimulation()},s([h(cc.Integer)],t.prototype,"cellSize",void 0),s([h(cc.Integer)],t.prototype,"lineWidth",void 0),s([h],t.prototype,"isVsComputer",void 0),s([c],t)}(cc.Component);r.default=l,cc._RF.pop()},{}]},{},["TicTacToe"]);